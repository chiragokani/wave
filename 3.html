<!DOCTYPE html>
<html>
<head>
  <title>Rayleigh integrals</title>
 <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
   </script>
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>
<script type="text/javascript">
window.MathJax = {
  tex: {
    macros: {
      Order: "{\\mathcal O}",
      vec: ['\\boldsymbol{#1}',1] ,
      divergence: "{\\boldsymbol{\\nabla}\\cdot\\,}",
      grad: "{\\boldsymbol\\nabla}",
      curl: "{\\boldsymbol\\nabla\\times\\,}",
      Laplacian: "{\\nabla^2}",
      dAlambertian: "{\\Box^2}",
      Order: "{\\mathcal O}",
      T: "{^\\mathsf{T}}",
      FTt: "{\\mathcal{F}_t}",
      IFTt: "{\\mathcal{F}_t^{-1}}",
      FTx: "{\\mathcal{F}_x}",
      IFTx: "{\\mathcal{F}_x^{-1}}",      
      FTr: "{\\mathcal{F}_\\rho}",
      IFTr: "{\\mathcal{F}_\\rho^{-1}}",    
      HT: "{\\mathcal{H}}",
      IHT: "{\\mathcal{H}^{-1}}",  
      FTxy: "{\\mathcal{F}_{xy}}",
      IFTxy: "{\\mathcal{F}_{xy}^{-1}}",
      rect: "{\\mathrm{\\,rect\\,}}",
      tri: "{\\mathrm{\\,tri\\,}}",
      circfn: "{\\mathrm{\\,circ\\,}}",
      sinc: "{\\mathrm{\\,sinc\\,}}",
      ex: "{\\hat{e}_x}",           
      ey: "{\\hat{e}_y}",
      ez: "{\\hat{e}_z}",
      ephi: "{\\hat{e}_\\phi}"
    }
  }
};
</script>	
  <style>
    body {
      margin: 20px;
      background:  #577abdd8; 
      font-family: Arial, sans-serif;
      height: 100%;
      background-repeat: no-repeat;
      background-attachment: fixed;
      line-height: 1.5;
    }

    .textbox {
      background-color: rgba(241, 241, 241, 0.986);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .example {
      background-color: rgba(197, 197, 197, 0.836);
      border-radius: 3px;
      padding-top: 1px;
      padding-bottom: 10px;
      padding-right: 20px;
      padding-left: 20px;
      margin-bottom: 20px;
      border-style: solid;
      border-width: thin;
      border-color: #9b9b9b94;
    }

    .wrong {
      background-color: rgba(255, 205, 205, 0.856);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    h1 {
      text-align: center;
    }

    nav {
      background-color: #0000003d;
      margin-bottom: 20px;
    }

    nav ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
    }

    nav ul li {
      flex: 1;
    }

    nav ul li a {
      display: block;
      color: #fff;
      text-decoration: none;
      text-align: center;
      padding: 3px;
    }

    nav ul li a:hover {
      background-color: #03030365;
    }

    .Q {
      color:  #9e0702;
      font-style: italic;
    }

    .floating-table-of-contents {
            position: fixed;
            top: 100%;
            right: 15pt;
            transform: translateY(-50%);
            background-color:  rgba(255, 255, 255, 0);
            padding: 3px;
            border-radius: 6px;
        }

        .toc-link {
            display: block;
            margin-bottom: 20px;
            color: #091c4165; 
            text-decoration: none;
            font-size:8pt;
        }
  </style>

</head>
<body>
  <nav>
    <ul>
	 <li><a href="index.html"> &#127968;</a></li>
      <li><a href="1.html">1</a></li>
      <li><a href="2.html">2</a></li>
      <li><a href="3.html"><b>3</b></a></li>
      <li><a href="4.html">4</a></li>
      <li><a href="5.html">5</a></li>
      <li><a href="6.html">6</a></li>
      <li><a href="7.html">7</a></li>
    </ul>
  </nav>

<nav class="floating-table-of-contents">
<a href="#top" class="toc-link">Back to top</a>
</nav>

<div class="textbox">
<h1 id="top">Rayleigh integrals</h1>
<blockquote><i>The only merit of which I personally am conscious was that of having pleased myself by my studies, and any results that may be due to my researches were owing to the fact that it has been a pleasure for me to become a physicist.</i></blockquote>
<p align="right">&ndash;<a href="https://en.wikiquote.org/wiki/John_Strutt,_3rd_Baron_Rayleigh" target="_blank" rel="noopener noreferrer">John Strutt, 3rd Baron Rayleigh</a></p>

<p>Fourier acoustics is now used to derive Rayleigh's famous diffraction integrals. The plane wave decomposition (angular spectrum) of a spherical wave is first needed to derive these integrals.</p>
<p>
  <i>Contents:</i>
<ul>
<li><a href="#angular">Angular spectrum of a spherical wave</a></li>
<li><a href="#Rayleigh">Derivation of the first Rayleigh integral using Fourier acoustics</a></li>
<li><a href="#Rayleigh2">Derivation of the second Rayleigh integral using Fourier acoustics</a></li>
</ul>	
</p>
</div>


<div class="textbox"><h2 id="angular">Angular specturm of a spherical wave</h2>
<div class=Q>Note that this topic is covered in Brekhovskikh, pages 228-229.</div>

<p>Let \(f(x,y,z) = e^{ikr}/r\) be the functional dependence of the radiation due to a point source at \(r=0\) (i.e., the amplitude factor has been neglected), where \(r = \sqrt{x^2+y^2+z^2}\) and \(\rho = \sqrt{x^2 + y^2}\). To obtain the plane wave decomposition (angular spectrum) of the spherical wave in all space, first calculate the 2D spatial Fourier transform of the wave at the source \(f(x,y,0)\): 
\begin{align*}
F_0(\kappa) = F_0(k_x,k_y) &= \FTxy \{f(x,y,0)\} = \iint_{-\infty}^\infty \frac{e^{ik\rho}}{\rho} e^{-i(k_xx + k_yy)}\, dx\, dy\\
&= \FTxy \{f(x,y,0)\} = \iint_{-\infty}^\infty \frac{e^{ik\rho}}{\rho} e^{-i\vec{\kappa}\cdot \vec{\rho}} \rho \, d\rho \, d\phi
\end{align*}
As before, due to axisymmetry, take \(\vec{\kappa} = \kappa \hat{e}_x\), giving
\begin{align*}
\vec{\kappa} \cdot \vec{\rho} = \kappa\rho \cos\phi\,.
\end{align*}
So
\begin{align*}
F_0(\kappa)= \int_{0}^{2\pi} d\phi \int_{0}^{\infty} e^{i(k-\kappa \cos \phi)\rho}d\rho\,.
\end{align*}
This is a tricky integral to take, since the integrand of the \(\rho\) integral is oscillatory. To evaluate the integral, let \(k = k + i\epsilon\) and then take \(\epsilon \to 0\). 
\begin{align*}
F_0(\kappa) &= \int_{0}^{2\pi} d\phi \frac{e^{i(k-\kappa\cos\phi)} e^{-\epsilon\rho}}{i(k-\kappa \cos\phi)-\epsilon}\bigg\rvert_{\rho=0}^{\rho = \infty}\\
&= -\int_{0}^{2\pi} \frac{d\phi}{i(k-\kappa \cos\phi)\rho-\epsilon}\\
&= i\int_{0}^{2\pi} \frac{d\phi}{k-\kappa \cos\phi} = i \frac{2\pi}{\sqrt{k^2- \kappa^2}} = \frac{i2\pi}{k_z}\,.
\end{align*}
Note that \(e^{ikr}/r\) is symmetric about the plane \(z=0\), as shown below: 
<p align="middle"> <img src="sphwave.svg" width="160" height="auto"></p>
With the Fourier transform of the source condition taken, the full field can therefore be calculated for all \(z\) (both positive and negative) using the standard Fourier acoustics procedure: 
\begin{align*}
f(x,y,z) = e^{ikr}/r &= \IFTxy\{F_0(\kappa) e^{ik_z|z|}\}\\
&= \IFTxy\bigg\{\frac{i2\pi}{k_z} e^{ik_z|z|}\bigg\}\,.
\end{align*}
Taking the 2D spatial Fourier transform of both sides above gives the plane wave decomposition of a spherical wave:
\begin{align*}
\boxed{\FTxy \{e^{ikr}/r\} = i2\pi \frac{e^{ik_z|z|}}{k_z}\,.}
\end{align*}
Since \(F(\kappa) = 2\pi F_H(\kappa)\), the above can conveniently be written in terms of the Hankel transform \(\HT_1\),
\begin{align*}
\HT_1 \{e^{ikr}/r\} = i\frac{e^{ik_z|z|}}{k_z}\,.
\end{align*}
<div class="example"><h3>Aside: evanescent waves in spherical radiation</h3>
Recall that the wavevector \(\vec{k}\) is related to its projection in the \(x\)-\(y\) plane by
<p align="middle"> <img src="spherical_annotated.svg" width="195" height="auto"></p>
Thus the Fourier transform of the source condition is
\begin{align*}
F_0(\kappa) &= \frac{i2\pi}{\sqrt{k^2-\kappa^2}}\\
&=\frac{i2\pi}{k\sqrt{1-\sin^2\gamma}}\\
&= \frac{i2\pi }{k\cos\gamma}\,,\quad \gamma \leq 90^\circ\,.
\end{align*}
<!--This is Weyl's integral, given by Williams Eq. (2.64).--> </p>
<p><span class="Q">The meaning of the evanescent waves in the plane wave decomposition of a spherical wave is not clear. For more insight into the presence of the evanescent waves in the spectrum of a converging spherical wave, see <a href="The_Evanescent_Spectrum_of_a_Spherical_Wave_JSH.pdf" target="_blank" rel="noopener noreferrer">these notes</a> by Jackson S. Hall.</span> </p>
</div>
</div>

<div class="textbox"><h2 id="Rayleigh">Derivation of first Rayleigh integral using Fourier acoustics</h2>
<div class="Q"><p>This is <i>not</i> how Rayleigh derived his integral. For that, see <a href="https://cag170030.github.io/quals/physical.html#13-14" target="_blank" rel="noopener noreferrer">here</a>. </p></div>

<p>Given an arbitrary normal velocity distribution
\begin{align*}
\vec{u} &= (x,y,0,t) = u_0(x,y) e^{-i\omega t} \ez \,.
\end{align*} 
Follow the recipe for the calculation of the field. The 2D spatial Fourier transform of the source condition, and its mapping to a pressure source, is
\begin{align*}
U_0(k_x,k_y,0) &= \FTxy \{u_0(x,y)\}\,,\\
P_0(k_x,k_y,0) &= \rho_0c_0 \frac{k}{k_z} U(k_x,k_y,0)\,.
\end{align*}
Then the solution to the Helmholtz equation is 
\begin{align*}
p_\omega(x,y,z) &= \IFTxy\{P_0(k_x,k_y) e^{ik_zz}\}\\
&= \rho_0c_0 k\, \IFTxy \{U_0 (k_x,k_y) e^{ik_zz}/k_z\}\\
&= \rho_0c_0 k\, \IFTxy \{U_0 (k_x,k_y)\} ** \IFTxy\{ e^{ik_zz}/k_z\}\\
&= \rho_0c_0 k\, u(x,y) ** \frac{e^{ikr}}{i2\pi r}\,,
\end{align*}
where \(r= \sqrt{x^2 + y^2 + z^2}\), and where the result from the previous section, \(\FTxy \{e^{ikr}/r\} = i2\pi e^{ik_z|z|}/k_z\), has been used to evaluate the third line above. Writing the convolution explicitly and denoting \[R = \sqrt{(x-x_0)^2 + (y-y_0)^2 + z^2}\] results in the so-called <i>Rayleigh integral of the first kind</i> of acoustics:
\begin{align*}
\boxed{p_\omega (x,y,z) = -\frac{ik\rho_0c_0}{2\pi} \iint_{-\infty}^\infty u_0(x_0,y_0) \frac{e^{ikR}}{R} dx_0 dy_0\,.}
\end{align*}
</p>

<div class="example"><h3>Example: Point velocity source (baffled monopole):</h3>
The source condition for a point velocity source is
\begin{align*}
u_0(x,y) &= Q\delta(x)\delta(y)\,,
\end{align*}
where \(Q\) is a volume velocity. Insertion of this source condition into the Rayleigh integral gives
\begin{align*}
p_\omega(r) &= -\frac{ik\rho_0c_0Q}{2\pi} \iint_{-\infty}^\infty \delta(x_0) \delta(y_0)\frac{e^{ikR}}{R} dx_0\, dy_0\\
&= -\frac{ik\rho_0c_0Q}{2\pi} \frac{e^{ikr}}{r} = -i\omega Q \frac{\rho_0e^{ikr}}{2\pi r}\,. 
\end{align*}
This is the expression for a monopole radiating in a half-space. Multiply by \(1/2\) for the expression for the radiation due to a monopole in free space. 
</div>
</div>

<div class="textbox"><h2 id="Rayleigh2">Derivation of second Rayleigh integral using Fourier acoustics</h2>
<p><span class=Q>Note that this is called the first Rayleigh integral of optics, because it is more common in optics to calculate the electric field beyond the source in terms of the electric field at the source.</span></p>

<p>Now consider a <i>pressure</i> source
\begin{align*}
p(x,y,0,t) = p_0(x,y) e^{-i\omega t}\,.
\end{align*}
Then take its 2D spatial Fourier transform:
\begin{align*}
P_0(k_x,k_y) = \FTxy\{p_0(x,y)\}\,.
\end{align*}
The full field is given by 
\begin{align*}
p_\omega(x,y,z) &= \IFTxy \{P_0(k_x,k_y) e^{ik_zz}\}\\
&= p_0(x,y) ** \IFTxy\{e^{ik_zz}\}
\end{align*}
Note that 
\begin{align*}
\IFTxy\{e^{ik_zz}\} &= \IFTxy\{ik_z e^{ik_zz}/ik_z\}\\
&= \frac{\partial}{\partial z} (-e^{ikr}/2\pi r) 
\end{align*}
<span class="Q">where the first line holds by multiplication and division by \(1\), and where second line holds <a href="#angular">because</a> \(\FTxy\{e^{ikr}/r\} = (i2\pi/k_z) e^{ik_z|z|}\)  and thus \(-e^{ikr}/2\pi r = -\IFTxy \{(i/k_z) e^{ik_z|z|}\} = \IFTxy \big\{ \frac{1}{ik_z} e^{ik_z|z|} \big \}\), so
\begin{align*}
\IFTxy \{ e^{ik_z|z|}\} = \IFTxy \bigg\{ \frac{\partial}{\partial z} \bigg[\frac{1}{ik_z} e^{ik_z|z|} \bigg]\bigg \} &=  \frac{\partial}{\partial z} \IFTxy \bigg\{\bigg[\frac{1}{ik_z} e^{ik_z|z|} \bigg]\bigg \}\\
&= \frac{\partial}{\partial z}(-e^{ikr}/2\pi r) \,.
\end{align*}</span>
So the pressure field can be written as a convolution:
\begin{align*}
p_\omega(x,y,z)
&= p_0(x,y) ** \frac{\partial}{\partial z} (-e^{ikr}/2\pi r) \,.
\end{align*}
Writing the convolution explicitly results in 
\begin{align*}
p_\omega(x,y,z) = -\frac{1}{2\pi} \iint_{-\infty}^\infty p_0(x_0,y_0) \frac{\partial}{\partial z} \frac{e^{ikR}}{R} dx_0 dy_0 \,.
\end{align*}
Noting that 
\begin{align*}
\frac{\partial }{\partial z} (e^{ikR}/R) = (ik- 1/R) \frac{e^{ikR}}{R} \frac{\partial R}{\partial z}
\end{align*}
and 
\begin{align*}
\frac{\partial R}{\partial z} &= \frac{\partial}{\partial z }\sqrt{(x-x_0)^2 + (y-y_0)^2 + z^2}\\
&= \frac{2z}{2R} = z/R\,,
\end{align*}
the partial derivative in the above integral becomes 
\begin{align*}
\frac{\partial }{\partial z} (e^{ikR}/R) &= (ik- 1/R) \frac{e^{ikR}}{R} \frac{z}{R}\\
&= ikz (1- 1/ikR) \frac{e^{ikR}}{R^2}\,.
\end{align*}
The integral above then becomes the second Rayleigh integral of acoustics, 
\begin{align*}
\boxed{p_\omega(x,y,z) = -\frac{ikz}{2\pi} \iint_{-\infty}^\infty p_0(x_0,y_0) (1- 1/ikR) \frac{e^{ikR}}{R^2} dx_0 dy_0\,.}
\end{align*}</p>
</div>

</body>
</html>
