<!DOCTYPE html>
<html>
<head>
  <title>Fourier acoustics and angular spectra</title>
 <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async
          src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
   </script>
<script>
window.MathJax = {
  tex: {
    tags: 'ams'
  }
};
</script>
<script type="text/javascript">
window.MathJax = {
  tex: {
    macros: {
      Order: "{\\mathcal O}",
      vec: ['\\boldsymbol{#1}',1] ,
      div: "{\\boldsymbol{\\nabla}\\cdot}",
      grad: "{\\boldsymbol\\nabla}",
      curl: "{\\boldsymbol\\nabla\\times}",
      Laplacian: "{\\nabla^2}",
      dAlambertian: "{\\Box^2}",
      Order: "{\\mathcal O}",
      T: "{^\\mathsf{T}}",
      FTt: "{\\mathcal{F}_t}",
      IFTt: "{\\mathcal{F}_t^{-1}}",
      FTxy: "{\\mathcal{F}_{xy}}",
      IFTxy: "{\\mathcal{F}_{xy}^{-1}}",
      rect: "{\\mathrm{\\,rect\\,}}",
      tri: "{\\mathrm{\\,tri\\,}}",
      ex: "{\\hat{e}_x}",           
      ey: "{\\hat{e}_y}",
      ez: "{\\hat{e}_z}"
    }
  }
};
</script>	
  <style>
    body {
      margin: 20px;
      background: linear-gradient(to bottom, #577abdd8, #e9bb58dc);
      font-family: Arial, sans-serif;
      height: 100%;
      background-repeat: no-repeat;
      background-attachment: fixed;
      line-height: 1.5;
    }

    .textbox {
      background-color: rgba(241, 241, 241, 0.925);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    .example {
      background-color: rgba(197, 197, 197, 0.836);
      border-radius: 3px;
      padding-top: 0px;
      padding-bottom: 0px;
      padding-right: 20px;
      padding-left: 20px;
      margin-bottom: 5px;
      border-style: solid;
      border-width: thin;
      border-color: #9b9b9b94;
    }

    .wrong {
      background-color: rgba(255, 205, 205, 0.856);
      border-radius: 10px;
      padding: 20px;
      margin-bottom: 20px;
    }

    h1 {
      text-align: center;
    }

    nav {
      background-color: #0000003d;
      margin-bottom: 20px;
    }

    nav ul {
      list-style-type: none;
      padding: 0;
      margin: 0;
      display: flex;
    }

    nav ul li {
      flex: 1;
    }

    nav ul li a {
      display: block;
      color: #fff;
      text-decoration: none;
      text-align: center;
      padding: 3px;
    }

    nav ul li a:hover {
      background-color: #03030365;
    }

    .Q {
      color:  #9e0702;
      font-style: italic;
    }

    .floating-table-of-contents {
            position: fixed;
            top: 100%;
            right: 15pt;
            transform: translateY(-50%);
            background-color:  rgba(255, 255, 255, 0);
            padding: 3px;
            border-radius: 6px;
        }

        .toc-link {
            display: block;
            margin-bottom: 20px;
            color: #577bbd59; 
            text-decoration: none;
            font-size:8pt;
        }
  </style>

</head>
<body>
  <nav>
    <ul>
	 <li><a href="index.html"> &#127968;</a></li>
      <li><a href="1.html">1</a></li>
      <li><a href="2.html">2</a></li>
      <li><a href="3.html">3</a></li>
      <li><a href="4.html">4</a></li>
      <li><a href="5.html">5</a></li>
      <li><a href="6.html">6</a></li>
      <li><a href="7.html">7</a></li>
    </ul>
  </nav>

<nav class="floating-table-of-contents">
<a href="#top" class="toc-link">Back to top</a>
</nav>

<div class="textbox">
<h1 id="top">Fourier acoustics and angular spectra</h1>

<p>
  <i>Contents:</i>
<ul>
<li><a href="#linear">Linear systems theory</a></li>
<li><a href="#1D">1D Fourier transform</a></li>
<li><a href="#2D">2D spatial Fourier transform </a></li>
<li><a href="#transform_theorems">Transform theorems</a></li>
<li><a href="#angspec">The angular spectrum</a></li>

</ul>	
Difficult topics are coloured red, and my personal comments/questions are in <span class="Q">italicized red</span>. </p>
</div>

<div class="textbox"><h2 id="linear">Linear systems theory</h2>
<p>We begin by discussing the time transform. Fourier transforms are linear operations and hence lend themselve to problems that are linear. The temporal Fourier transform (FT) pair is given by
\begin{align}
X(\omega) &= \FTt\{x(t)\} = \int_{-\infty}^{\infty} x(t) e^{i\omega t} dt\\
x(t) &= \IFTt \{X(\omega)\} = \frac{1}{2\pi} \int_{-\infty}^{\infty} X(\omega) e^{-i\omega t} d\omega
\end{align}
The response of a linear system is illustrated schematically below: 
\begin{align*}
x(t) \xrightarrow{\FTt\{x(t)\}} X(\omega) \xrightarrow{H(\omega) X(\omega)} Y(\omega)\xrightarrow{\IFTt\{Y(\omega)\}} y(t)\,,
\end{align*}
where \(H(\omega)\) is the so-called transfer function. </p>

<p><span class="Q">I find it helpful to remember that "\(\mathcal{F}\)" (\(\texttt{\mathcal{F}}\) in LaTeX) corresponds to the operator \(\int_{-\infty}^\infty \dots dt\), while an upper case letter corresponds to the transformed lower case function.</span></p> 

<div class="example"><h3>Example: Wave propagation from position \(x,y,z=z_0\) to \(x,y,z=z_0 + \Delta z\) </h3>
<p>As a sneak-peek for what is to come, we outline (informally) how use the Fourier transform (both temporal and spatial, discussed further in the following sections) to propagate from position \(x,y,z=z_0\) to a parallel plane \(x,y,z=z_0 + \Delta z\) following <a href="#linear">the general "recipe" provided above</a>.
<p align="middle"> <img src="FTexample.svg" width="225" height="auto"></p>
First take the Fourier time transform \(\FTt\) to obtain \(p_\omega\):
\begin{align*}
p(x,y,z,t_0) \xrightarrow{\FTt\{p(x,y,z,t_0)\}} p_\omega(\omega,x,y,z_0)\,.
\end{align*}
Then take the 2D spatial Fourier transform to obtain \(P_\omega(k_x,k_y,z_0)\) (note capital letters are used for quantities in \(k\)-space):
\begin{align*}
p_\omega(\omega,x,y,z_0)\xrightarrow{\FTxy\{p_\omega(x,y,z_0)\}} P_\omega(k_x,k_y,z_0) \,.
\end{align*}
Next, apply the transfer function to \(P_\omega(k_x,k_y,z_0)\) to advance spatially. 
\begin{align*}
P_\omega(k_x,k_y,z_0) \xrightarrow{H(k_x,k_y) P_\omega(k_x,k_y,z_0)}  P_\omega(k_x,k_y,z_0 + \Delta z) \,.
\end{align*}
Finally, take the inverse 2D spatial FT to return from \(k\)-space to physical space. 
\begin{align*}
P_\omega(k_x,k_y,z_0 + \Delta z)\xrightarrow{\IFTxy \{P_\omega(k_x,k_y,z_0 + \Delta z)\}}  p_\omega(x,y,z+\Delta z)\,.
\end{align*}
The above step shall be the stopping point in this class (since we will work largely in \(k\)-space, i.e., our interest is in solving the Helmholtz equation, not the wave equation). If desired, however, one can take the inverse time Fourier transform, viz., \(\IFTt\{p_\omega(x,y,z+\Delta z)\}\) to obtain \(p(x,y,z+\Delta z,t)\).</p>

<p>
What is the transfer function? We will find that 
\[H(k_x,k_y) = e^{ik_z\Delta z},\quad k_z = \sqrt{\frac{\omega^2}{c_0^2} - k_x^2 - k_y^2}\,.\]</p>

How should one correctly interpret \(p_\omega\) in the equations above? We will represent the time dependence as 
\begin{align*}
p(\vec{r},t) = p_\omega (\vec{r}) e^{-i\omega t} = |p_\omega(r)| e^{i\phi_\omega(\vec{r})} e^{-i\omega t}
\end{align*}
and interpret \(|p_\omega(\vec{r})|\) as the peak pressure of \(p(t)\).</p>

<p>Do not try to identify \(p_\omega\) from \(P_\omega\), as illustrated in the following example: Consider the pressure wave \(p(t)=p_0\cos\omega_0t\). Since there is no spatial dependence, \(p_\omega\) should be identified as \(p_0\). Meanwhile, the time FT is
\begin{align*}
\FTt \{p_0\cos\omega_0t\}&= \int_{-\infty}^{\infty} p_0\frac{e^{i\omega_0 t} + e^{-i\omega_0 t} }{2} e^{i\omega t} dt\\
&= \frac{p_0}{2}\int_{-\infty}^{\infty} (e^{i\omega_0 t} + e^{-i\omega_0 t}) e^{i\omega t} dt\\
&= \pi p_0 [\delta(\omega+\omega_0) + \delta(\omega-\omega_0)]\,,
\end{align*}
where one might be tempted to define \(p_\omega \) as \(\pi p_0\).
</p>
</div>
</div>


<div class="textbox"><h2 id="1D">1D Fourier transform</h2>
<p>For this discussion, consider the 1D spatial Fourier transform:
\begin{align}
F(k_x) &= \mathcal{F}_x \{f(x)\} = \int_{-\infty}^{\infty} f(x)e^{-ik_xx}dx \label{F}\tag{1}\\
f(x) &= \mathcal{F}_x^{-1} \{F(k_x)\} = \frac{1}{2\pi}\int_{-\infty}^{\infty} F(k_x)e^{ik_xx}dk_x\,. \label{f}\tag{2}
\end{align}
The sign convention corresponds to the \(e^{-i\omega t}\) time dependence such that 
\begin{align*}
f(x) e^{-i\omega t} = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(k_x) e^{i(k_xx-\omega t)} dk_x
\end{align*}
is a forward-traveling wave.</p>

<p>Some authors, e.g., Goodman let \(k_x = 2\pi f_x\) such that the Fourier transforms are symmetric.
\begin{align*}
\mathcal{F}_x^G \{f(x)\} &= \int_{-\infty}^{\infty} f(x) e^{-i2\pi f_xx}dx \equiv F^G(k_x)\\
\mathcal{F}_x^{-1,G} \{F(k_x)\} &= \int_{-\infty}^{\infty} F^G(k_x) e^{i2\pi f_xx}df_x\,,
\end{align*}
where \(dk_x = 2\pi df_x\). We will avoid this in favour of Eqs.  Eqs. \eqref{F} and \eqref{f}. Simply beware of these alternate definitions.</p>

<p>Many more properties of Eqs. \eqref{F} and \eqref{f} are given in <a href="Papoulis.pdf" target="_blank" rel="noopener noreferrer">Papoulis's table</a> with the following substitutions:
\begin{align*}
t\mapsto x\\
\omega \mapsto k_x\\
j \mapsto i\,.
\end{align*}
</p>

<div class="example"><h3>Example: Fourier transform of a rectangle function</h3>
Define 
\begin{align*}
\rect x = \begin{cases}
1, \quad |x| \leq 1/2\\
0, \quad |x| > 1/2
\end{cases}\,,
\end{align*}
and let 
\begin{align*}
f(x) = A \rect(x/L)\,.
\end{align*}
Take the Fourier transform: 
\begin{align*}
\mathcal{F}_x\{f(x)\} &= A\int_{-L/2}^{L/2} e^{-ik_xx}dx\\
&= \frac{A}{-ik_x} (e^{-ik_xL/2} - e^{ik_xL/2})\\
&= \frac{2A}{k_x} \sin (k_xL/2)\\
&= AL \frac{\sin (k_xL/2)}{k_xL/2} = ALj_0(k_xL/2)\,.\\
&= AL,\quad k_x = 0\,.
\end{align*}
That is to say, the Fourier transform evaluated at \(k_x = 0\) is the area under the curve:
\begin{equation*}
F(k_x = 0) = \int_{-\infty}^{\infty} f(x)dx\,.
\end{equation*}
</div>
</div>


<div class="textbox"><h2 id="2D">2D spatial Fourier transform </h2>
<p>The two-dimensional (2D) spatial FT will prove to be useful:
\begin{align*}
F(k_x,k_y) &= \FTxy \{f(x,y)\} = \iint_{-\infty}^\infty f(x,y) e^{-i(k_xx+ k_yy)}dxdy\\
f(x,y) &= \IFTxy \{F(k_x,k_y)\} = \frac{1}{4\pi^2}\iint_{-\infty}^\infty F(k_x,k_y) e^{i(k_xx+ k_yy)}dk_xdk_y
\end{align*}
Wavenumber space is sometimes referred to as "\(k\)-space." Note that \(k\)-space itself arises in the first place from taking a time FT (of the wave equation). Beware of the different sign conventions used in physics and engineering.</p>

<p>In class, the "\(xy\)" subscripts of \(\mathcal{F}\) were dropped for convenience, but I shall retain them in the online notes for clarity. 
\begin{align*}
F(k_x,k_y) &= \FTxy \{f(x,y)\} = \iint_{-\infty}^\infty f(x,y) e^{-i(k_xx + k_yy)} dx dy\\
f(x,y) &= \IFTxy \{F(k_x,k_y)\} = \frac{1}{4\pi^2}\iint_{-\infty}^\infty F(k_x,k_y) e^{i(k_xx + k_yy)} dx dy
\end{align*}
Note that the operators commute:
\begin{align*}
\FTxy\{f(x,y)\} &= \mathcal{F}_y\{\mathcal{F}_x [f(x,y)]\}\\
&= \mathcal{F}_x\{\mathcal{F}_y [f(x,y)]\}
\end{align*}
and if \(f(x,y) = g(x)h(y)\) then \(\mathcal{F}\{f(x,y)\} = G(k_x)H(k_y)\). </p>

<p>Finally, note that a vectorial form of the 2D spatial Fourier transform is often utilized. Let 
\begin{align*}
\rho &= (x,y) = x\hat{e}_x + y\hat{e}_y\\
\vec{\kappa} &= (k_x,k_y) = k_x\ex + k_y\ey\,,
\end{align*}
so \(\vec{\rho}\cdot\vec{\kappa} = k_xx + k_yy\). Then the 2D spatial Fourier transform pair reads 
\begin{align*}
F(\vec{\kappa}) &= \int f(\vec{\rho})e^{-i\vec{\kappa}\cdot\vec{\rho}} d\vec{\rho}\\
f(\vec{\rho}) &= \int F(\vec{\kappa})e^{i\vec{\kappa}\cdot\vec{\rho}} d\vec{\kappa}\,.
\end{align*}
 </p>

<p><span class="Q">The notation in this section might be slightly confusing, because \(F\) refers to the transformed "version" of \(f\), whereas \(\mathcal{F}\) is the integral transformation. It helps to loosely think, "\(f\) is the uncooked meal, \(F\) is the cooked meal, and \(\mathcal{F}\) is the microwave." </span> </p>
</div>


<div class="textbox"><h2 id="transform_theorems">Transform theorems </h2>
<p>A full list of some <a href="Fourier_thms.pdf" target="_blank" rel="noopener noreferrer">transformation theorems is provided here</a>. Some will be proven as homework problems. The theorems in that document are in terms of the 2D spatial Fourier transform. Here, we prove two theorems for the 1D spatial Fourier transform relating to <b>similarity</b> and <b>differentiation</b>. They can straightforwardly generalized to the 2D case.</p>

<h3>Similarity.</h3> 
<p> If \(\mathcal{F}_x\{f(x)\} = F(k_x)\), then what is \(\mathcal{F}_x \{f(ax)\}\)? To find out, we simply apply the definition of the 1D spatial Fourier transform:
\begin{align*}
\mathcal{F}_x \{f(ax)\} &= \int_{-\infty}^{\infty} f(ax) e^{-ik_xx}dx\\
\end{align*}
To evaluate the integral, the substitution \(u = ax\) (and hence \(dx = du/a\)) is used. Note that the sign of \(a\) determines which integral is to be taken:
\begin{align*}
\mathcal{F}_x \{f(ax)\} &=\begin{cases}
 \int_{-\infty}^{\infty} f(u) e^{-ik_xu/a}\frac{du}{a},\quad &a > 0\\
 \int_{\infty}^{-\infty} f(u) e^{-ik_xu/a}\frac{du}{a},\quad &a < 0
\end{cases}
\end{align*}
To eliminate the conditional statement above, simply consider the magnitude of \(a\):
\begin{align*}
\mathcal{F}_x \{f(ax)\} &= \int_{-\infty}^{\infty} f(u) e^{-ik_xu/a}\frac{du}{|a|},\quad \forall a\\
&= \frac{1}{|a|}\int_{-\infty}^{\infty} f(u) e^{-ik_xu/a}\,du\,.
\end{align*}
Recalling Eq. \eqref{F}, \(F(k_x) = \mathcal{F}_x \{f(x)\} = \int_{-\infty}^{\infty} f(x)e^{-i k_x x }dx\), the integral above is identified as \(F(k_x/a)\). This is done by corresponding \(u\) above as \(x\) in Eq. \eqref{F}, and corresponding \(k_x/a\) above as \(k_x\) in Eq. \eqref{F}. Thus,
\[\mathcal{F}_x\{ f(ax)\} = \frac{1}{|a|} F(k_x/a)\,. \]
</p>

<h3>Differentiation.</h3> 
<p>
In particular, let us consider the Fourier transform of the \(n^\text{th}\) derivative of \(f(x)\):
\begin{align*}
\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} f(x) \bigg\}\,,
\end{align*}
which we can write as 
\[\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} \mathcal{F}_x^{-1}[F(k_x)] \bigg\}\]
because \(\mathcal{F}_x^{-1}[F(k_x)] = f(x)\).

Invoking Eq. \eqref{f}, the Fourier transform is written explicitly: 
\begin{align*}
\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} f(x) \bigg\} 
&= \mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} \frac{1}{2\pi}\int_{-\infty}^{\infty}[F(k_x)]e^{ik_xx} dk_x \bigg\} \\
\end{align*}
The derivative is brought inside the integral and is evaluated:  
\begin{align*}
\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} f(x) \bigg\} 
&= \mathcal{F}_x \bigg\{\frac{1}{2\pi}\int_{-\infty}^{\infty} (ik_x)^n F(k_x)e^{ik_xx} dk_x \bigg\}
\end{align*}
Again by Eq. \eqref{f}, the inverse spatial Fourier transform is identified:
\[\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} f(x) \bigg\} = \mathcal{F}_x \{\mathcal{F}_x^{-1} [(ik_x)^n F(k_x)]\} \]
Since the forward and inverse transform are inverses, we obtain
\[\mathcal{F}_x \bigg\{ \frac{\partial^n}{\partial x^n} f(x) \bigg\} = (ik_x)^n F(k_x)\,.\]
</p>

<div class="example"><h3>Example: Fourier transform of triangle function</h3>
<p>
Define 
\begin{align*}
\tri(x) = \Lambda(x) \equiv \begin{cases}
1-|x|\,, |x|\leq 1\\
0\,, |x| >1
\end{cases}\,.
\end{align*}
</p>
<p align="middle"><iframe src="https://www.desmos.com/calculator/ebrrkyojsp?embed" width="150" height="150" style="border: 1px solid #ccc" frameborder=0></iframe></p>

<p>In this example, we evaluate the Fourier transform of the function 
\begin{align*}
f(x) = A \Lambda(x/L) 
\end{align*}
rather cleverly. We will use the derivative theorem to obtain the Fourier transform of this function (rather than take the FT directly). In particular, the derivative of \(f(x) = A \Lambda(x/L) \) is 
\begin{align*}
f'(x) &= \frac{A}{L}\bigg[\rect \bigg(\frac{x+ L/2}{L}\bigg) - \rect \bigg(\frac{x- L/2}{L}\bigg) \bigg]\,.
\end{align*} 
<p align="middle"><iframe src="https://www.desmos.com/calculator/zsw0puslzx?embed" width="150" height="150" style="border: 1px solid #ccc" frameborder=0></iframe></p>
<a href="#1D">Earlier</a>, we found that the Fourier transform of the rectangle function is
\begin{align*}
\mathcal{F}_x\bigg\{ \rect \frac{x}{L}\bigg\} &= L \frac{\sin(k_xL/2)}{k_xL/2}\,.
\end{align*}
The shifting property is used (which will be proved as a homework problem):
\begin{align*}
\mathcal{F}_x \{ f(x-a)\} &= F(k_x) e^{-ik_xa}\,.
\end{align*}
So the Fourier transform of the <i>derivative</i> of the triangle function is
\begin{align*}
\mathcal{F}_x \{f'(x)\} &= A \frac{\sin(k_xL/2)}{k_xL/2} (e^{ik_xL/2} - e^{-ik_xL/2})\,.
\end{align*}
But \(e^{ik_xL/2} - e^{-ik_xL/2} = 2i \sin (k_xL/2)\). So we have (after normalization)
\begin{align*}
\mathcal{F}_x \{f'(x)\} &= ik_x AL \bigg[\frac{\sin(k_xL/2)}{k_xL/2} \bigg]^2\,.
\end{align*}
However, this is the Fourier transform of the <i>derivative</i> of the triangle function. Thus we using the derivative theorem for \(n= 1\), 
\begin{align*}
\mathcal{F}_x\bigg\{ \frac{\partial }{\partial x} f(x)\bigg\} = ik_x F(k_x)\,,
\end{align*} 
to obtain the derivative of the triangle function:  
\begin{align*}
F(k_x) = \mathcal{F}_x\{f(x)\} = AL\bigg[\frac{\sin(k_xL/2)}{k_xL/2} \bigg]^2\,.
\end{align*}
As a sanity check, evaluate the FT at the origin of \(k\)-space and see if we obtain the area under \(f(x)\). Indeed, \(F(k_x) = AL\), which is indeed the area under the triangle function.</p>
</div>
</div>

<div class="textbox"><h2 id="angspec">The angular spectrum</h2>
<p>
The above discussion has been purely mathematical. Now let us apply this mathematics to the study of wave phenomena. </p>

<p>Consider a time-harmonic acoustic pressure field:
\begin{align*}
p(x,y,z,t) &= p_\omega(x,y,z) e^{-i\omega t}\,.
\end{align*}
Thus the wave equation becomes 
\begin{align}
\Laplacian p_\omega + k^2 p_\omega  = 0\,. \label{Helm}\tag{1}
\end{align}
Let \(p_\omega\) be an arbitrary field propagating in the \(+z\) direction. At a given instant, it passes through the plane \(z = 0\). 
<p align="middle"> <img src="wavesinz.svg" width="225" height="auto"></p>

Let us characterize the field in the plane \(z =0\) as
\begin{align*}
p_\omega (x,y,0) = p_0(x,y)\,.
\end{align*}
The two spatial Fourier transform of this source condition is 
\begin{align}
P_0(k_x,k_y) = \iint_{-\infty}^\infty p_0(x,y) e^{-i(k_xx + k_yy)} dx dy\,, \label{angularspec}\tag{2}
\end{align}
so
\begin{align}
p_0(x,y) = \iint_{-\infty}^\infty P_0(k_x,k_y) e^{i(k_xx + k_yy)} dk_x dk_y\,. \label{angularspec'}\tag{3}
\end{align}
Note that a general plane-wave solution of Eq. \eqref{Helm} is 
\begin{align*}
p_\omega(x,y,z) = Ae^{i(k_xx + k_yy + k_zz)} = A e^{i\vec{k}\cdot \vec{r}}\,,
\end{align*}
where \(k = k_x\ex + k_y\ey + k_z\ez\) and \(|\vec{k}| = \omega/c_0\). Thus 
\begin{align*}
k_z = \sqrt{k^2 -k_x^2 - k_y^2}\,.
\end{align*}
Thus Eq. \eqref{angularspec'} is a superposition of plane waves passing through the plane \(z = 0\) with complex amplitudes 
\begin{align*}
A(k_x,k_y) = P_0(k_x,k_y) \frac{dk_x dk_y}{4\pi^2}\,.
\end{align*}
Each plane wave in the summation is uniquely determined by the pair \((k_x,k_y)\). Now write
\begin{align*}
\vec{k} &= k_x\ex + k_y\ey + k_z\ez\\
&= \vec{\kappa} + k_z \ez\,.
\end{align*}
Now we introduce spherical coordinates, where the meaning of the \(z\) axis is preserved between the Cartesian and spherical coordinates:
\begin{align*}
k_x &= k\sin\gamma \cos \psi\\
k_y &= k\sin\gamma \sin \psi\\
k_z &= k\cos \gamma\,,
\end{align*}
where \(\gamma \) is the polar angle, while \(\psi\) is the azimuthal angle. 
<p align="middle"> <img src="spherical.svg" width="150" height="auto"></p>

The ordered pair \((k_x,k_y)\) is uniquely defined by \((\psi,\gamma)\), and hence 
\begin{align*}
P_0(k_x,k_y) &= \text{ angular spectrum}
=  P_0(\gamma,\psi)\,.
\end{align*}
Note that only components for which \(k_x^2 + k_y^2 < k^2\) can propagate. That is, outside we are outside a circle of radius \(|\vec{k}| = \omega/c_0\):
<p align="middle"> <img src="prop_evan.svg" width="170" height="auto"></p>


</p>


</div>



<!--<div class="wrong"><h2 id="4">1-4</h2>
I, humble bat.   
</div>-->

</div>
</body>
</html>
